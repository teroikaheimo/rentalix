(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{26:function(e,t,a){e.exports=a(38)},31:function(e,t,a){},33:function(e,t,a){},38:function(e,t,a){"use strict";a.r(t);var n=a(1),i=a.n(n),r=a(14),s=a.n(r),o=(a(31),a(5)),l=a(6),d=a(8),c=a(7),u=a(9),m=a(3),p=a(42),h=a(41),f=a(40),g=(a(33),a(13)),w={getAllAvaileable:"/items/",getItem:"/items/getitem",insertItem:"/items/insert",modifyItem:"/items/modify",deleteItem:"/items/delete",login:"/login",logout:"/logout",register:"/register/",usernameAvailable:"/register/available",getCategories:"/items/category",getOwner:"/items/owner",getAddress:"/items/address",updatePassword:"/user/modify",getUserRents:"/items/rent",getAllRents:"/items/rent/all",reserveInsert:"/items/reserve/insert",reserveModify:"/items/reserve/modify",reserveDelete:"/items/reserve/delete",rentInsert:"/items/rent/insert",rentModify:"/items/rent/modify",rentReturn:"/items/rent/return",rentReturnReserved:"/items/rent/returnreserved"},v=new(function(){function e(){Object(o.a)(this,e),this.username="",this.authenticated=!1,this.admin=!1,this.userId="",console.log("RESET")}return Object(l.a)(e,[{key:"usernameAvailable",value:function(e){return new Promise(function(t,a){fetch(w.usernameAvailable,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:e})}).then(function(e){return e.json()}).then(function(e){e.success?t(e.success):(console.log(e),a(!1))}).catch(function(e){return console.log(e)})})}},{key:"register",value:function(e,t,a){var n=this;return new Promise(function(i,r){n.usernameAvailable(e)&&e.length>3&&t===a&&fetch(w.register,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})}).then(function(e){return e.json()}).then(function(e){e.success?i(!0):r(!1)}).catch(function(e){return console.log(e)})})}},{key:"login",value:function(e,t){var a=this;return new Promise(function(n,i){e.length>3&&t.length>3&&fetch(w.login,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})}).then(function(e){return e.json()}).then(function(e){var t={};e[0]?(a.admin=1===e[0].admin,a.authenticated=!0,a.username=e[0].username,a.userId=e[0].id,t.username=e[0].username,t.admin=1===e[0].admin,t.id=e[0].id,n(t)):e.logged?(a.admin=1===e.admin,a.authenticated=!0,a.username=e.username,a.userId=e.id,t.username=e.username,t.admin=1===e.admin,t.id=e.id,n(t)):i(!1)}).catch(function(e){return console.log(e)})})}},{key:"logout",value:function(){var e=this;return new Promise(function(t,a){fetch(w.logout,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(n){n.success?(e.authenticated=!1,t(!0)):a("logout failed")}).catch(function(e){return console.log(e)})})}},{key:"isAuthenticated",value:function(){var e=this;return new Promise(function(t,a){fetch(w.login,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({})}).then(function(e){return e.json()}).then(function(n){n.logged?(e.admin=n.admin,e.authenticated=!0,e.username=n.username,t(!0)):a(!1)})})}},{key:"isAdmin",value:function(){return this.admin}},{key:"getUsername",value:function(){return this.username}}]),e}()),y=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(d.a)(this,Object(c.a)(t).call(this,e)))._handleKeyPress=function(e){"Enter"===e.key&&a.tryLogin()},a.handleChange=function(e){a.setState(Object(g.a)({},e.target.id,e.target.value))},a.state={inputUsernameLog:"",inputPasswordLog:"",inputUsernameReg:"",inputPasswordReg:"",inputPasswordConfReg:"",regOk:"undefined",pwdMatch:!0,pwdCheckedOnce:!1,usernameAvailable:!0,usernameLength:!0,authenticated:!1,loginFail:!1},a.checkPwdMatch=a.checkPwdMatch.bind(Object(m.a)(Object(m.a)(a))),a.checkUsername=a.checkUsername.bind(Object(m.a)(Object(m.a)(a))),a.handleChange=a.handleChange.bind(Object(m.a)(Object(m.a)(a))),a.registerUser=a.registerUser.bind(Object(m.a)(Object(m.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"checkPwdMatch",value:function(){this.setState({pwdCheckedOnce:!0}),this.state.inputPasswordReg===this.state.inputPasswordConfReg&&this.state.inputPasswordReg.length>3?this.setState({pwdMatch:!0}):this.setState({pwdMatch:!1})}},{key:"checkUsername",value:function(){var e=this;this.state.inputUsernameReg.length>3?(v.usernameAvailable(this.state.inputUsernameReg).then(function(){e.setState({usernameAvailable:!0})}).catch(function(){e.setState({usernameAvailable:!1})}),this.setState({usernameLength:!0})):this.setState({usernameLength:!1,usernameAvailable:!0})}},{key:"displayRegTip",value:function(){return"undefined"===typeof this.state.pwdChangeOk?"":!0===this.state.pwdChangeOk?i.a.createElement("div",{className:"alert alert-success",role:"alert"},"Registering was ",i.a.createElement("strong",null,"successful!")):!1===this.state.pwdChangeOk?i.a.createElement("div",{className:"alert alert-danger",role:"alert"},"Registering ",i.a.createElement("strong",null,"failed"),"!"):void 0}},{key:"setLoginFail",value:function(e){this.setState({loginFail:e})}},{key:"tryLogin",value:function(){var e=this;(this.state.inputUsernameLog<1||this.state.inputPasswordLog<1)&&this.setLoginFail(!0),this.props.Login(this.state.inputUsernameLog,this.state.inputPasswordLog).then(function(){e.setLoginFail(!1),e.props.history.push("/main")}).catch(function(){e.setLoginFail(!0)})}},{key:"registerUser",value:function(){var e=this;this.state.inputPasswordReg===this.state.inputPasswordConfReg&&this.state.inputPasswordReg.length>3?v.register(this.state.inputUsernameReg,this.state.inputPasswordReg,this.state.inputPasswordConfReg).then(function(){e.setState({pwdChangeOk:!0,loginFail:!1,inputUsernameLog:"",inputPasswordLog:"",inputUsernameReg:"",inputPasswordReg:"",inputPasswordConfReg:""})}).catch(function(){e.setState({pwdChangeOk:!1,loginFail:!1})}):this.setState({pwdChangeOk:!1,loginFail:!1})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"Login"},i.a.createElement("div",{className:"login text-center"},i.a.createElement("div",{className:"loginOther"},i.a.createElement("div",{className:"form-signin "},this.displayRegTip(),this.state.loginFail?i.a.createElement("div",{className:"alert alert-danger",role:"alert"},"Wrong username or password!"):"",i.a.createElement("h1",null,"RENTALIX"),i.a.createElement("h1",{className:"h3 mb-3 font-weight-normal"},"Please sign in"),i.a.createElement("label",{htmlFor:"inputUsernameLog",className:"sr-only"},"Username"),i.a.createElement("input",{type:"text",id:"inputUsernameLog",onChange:this.handleChange,className:"form-control my-1 py-3",placeholder:"Username",onKeyPress:this._handleKeyPress,required:!0,autoFocus:!0}),i.a.createElement("label",{htmlFor:"inputPasswordLog",className:"sr-only"},"Password"),i.a.createElement("input",{type:"password",id:"inputPasswordLog",onChange:this.handleChange,className:"form-control my-1 py-3",placeholder:"Password",onKeyPress:this._handleKeyPress,required:!0}),i.a.createElement("button",{className:"btn btn-lg btn-primary btn-block",type:"button",onClick:function(){e.tryLogin()}},"Sign in"),i.a.createElement("button",{type:"button",className:"btn btn-link","data-toggle":"modal","data-target":"#register"},"Register"),i.a.createElement("br",null)),i.a.createElement("div",{className:"modal fade",id:"register",tabIndex:"-1",role:"dialog","aria-labelledby":"registerCenterTitle","aria-hidden":"true"},i.a.createElement("div",{className:"modal-dialog modal-dialog-centered",role:"document"},i.a.createElement("div",{className:"modal-content"},i.a.createElement("div",{className:"modal-header"},i.a.createElement("h2",{className:"modal-title",id:"registerLongTitle"},"Register"),i.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},i.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),i.a.createElement("div",{className:"modal-body px-5"},i.a.createElement("label",{htmlFor:"inputUsernameReg",className:"sr-only"},"Username"),i.a.createElement("input",{type:"text",id:"inputUsernameReg",onChange:this.handleChange,onBlur:this.checkUsername,className:"form-control my-1 py-3",placeholder:"Username",required:!0,autoFocus:!0}),this.state.usernameAvailable?"":i.a.createElement(b,null),this.state.usernameLength?"":i.a.createElement(E,null),i.a.createElement("label",{htmlFor:"inputPasswordReg",className:"sr-only"},"Password"),i.a.createElement("input",{type:"password",id:"inputPasswordReg",onChange:this.handleChange,onBlur:this.state.pwdCheckedOnce?this.checkPwdMatch:function(){},className:"form-control my-1 py-3",placeholder:"Password",required:!0}),i.a.createElement("label",{htmlFor:"inputPasswordConfReg",className:"sr-only"},"Password confirmation"),i.a.createElement("input",{type:"password",id:"inputPasswordConfReg",onChange:this.handleChange,onBlur:this.checkPwdMatch,className:"form-control my-1 py-3",placeholder:"Password confirmation",required:!0}),this.state.pwdMatch||!this.state.pwdCheckedOnce?"":i.a.createElement(D,null)),i.a.createElement("div",{className:"modal-footer px-5 pb-5"},i.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Close"),i.a.createElement("button",{type:"button",onClick:this.registerUser,"data-dismiss":"modal",className:"btn btn-success"},"Register"))))))))}}]),t}(n.Component),b=function(){return i.a.createElement("div",{id:"usernameTaken",className:""},i.a.createElement("small",{id:"usernameHelp",className:"text-danger"},"Username is all ready taken!"))},E=function(){return i.a.createElement("div",{id:"usernameLength",className:""},i.a.createElement("small",{id:"usernameHelp",className:"text-danger"},"Username must be longer than three characters!"))},D=function(e){function t(){return Object(o.a)(this,t),Object(d.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{id:"pwdTip",className:""},i.a.createElement("small",{id:"passwordHelp",className:"text-danger"},"Passwords must be 4-30 long and they have to match!"))}}]),t}(n.Component),R=a(4),O=new(function(){function e(){Object(o.a)(this,e),this.itemData=[],this.itemToModifyId=""}return Object(l.a)(e,[{key:"fetchItems",value:function(e,t,a,n,i,r,s,o){return new Promise(function(l,d){fetch(w.getAllAvaileable,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:e||"",name:t||"",model:n||"",brand:a||"",itemInfo:i||"",address:r||"",owner:s||"",category:o||""})}).then(function(e){return e.json()}).then(function(e){l(e)}).catch(function(){d("Fetching failed!")})})}},{key:"getItem",value:function(e){return new Promise(function(t,a){fetch(w.getItems,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:e})}).then(function(e){return e.json()}).then(function(e){t(e)}).catch(function(e){a(e)})})}},{key:"insertItem",value:function(e,t,a,n,i,r,s){var o=this;return console.log(e,i,r),new Promise(function(l,d){fetch(w.insertItem,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({name:e||"",model:a||"",brand:t||"",itemInfo:n||"",address:i||"",owner:r||"",category:s||""})}).then(function(e){return e.json()}).then(function(e){o.itemData=e}).then(function(){l(!0)}).catch(function(){d(!1)})})}},{key:"modifyItem",value:function(e,t,a,n,i,r,s,o){return new Promise(function(l,d){fetch(w.modifyItem,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:e,name:t||"",model:n||"",brand:a||"",itemInfo:i||"",address:r||"",owner:s||"",category:o||""})}).then(function(e){return e.json()}).then(function(e){l(e)}).catch(function(){d("Item modify failed")})})}},{key:"deleteItem",value:function(e){var t=this;return new Promise(function(a,n){fetch(w.deleteItem,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:e||""})}).then(function(e){return e.json()}).then(function(e){t.itemData=e}).then(function(){a(!0)}).catch(function(){n(!1)})})}},{key:"getDropdownInfo",value:function(){var e={};return new Promise(function(t,a){fetch(w.getAddress,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(t){e.address=t}).catch(function(){a("Fetching addresses failed!")}),fetch(w.getCategories,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(t){e.category=t}).catch(function(){a("Fetching categories failed!")}),fetch(w.getOwner,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(a){e.owner=a,t(e)}).catch(function(){a("Fetching owners failed!")})})}},{key:"updatePassword",value:function(e,t,a){return new Promise(function(n,i){fetch(w.updatePassword,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:e,password:t,newPassword:a})}).then(function(e){return e.json()}).then(function(e){n(e)}).catch(function(){i("Password update failed")})})}},{key:"fetchUserRents",value:function(e){return new Promise(function(t,a){fetch(w.getUserRents,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:e||""})}).then(function(e){return e.json()}).then(function(e){t(e)}).catch(function(){a("Fetching user rents failed!")})})}},{key:"fetchAllRents",value:function(e){return new Promise(function(t,a){fetch(w.getAllRents,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:e.text||"",name:e.text||"",model:e.text||"",brand:e.text||"",address:e.address||"",owner:e.owner||"",category:e.category||""})}).then(function(e){return e.json()}).then(function(e){t(e)}).catch(function(){a("Fetching user rents failed!")})})}},{key:"rentInsert",value:function(e,t,a,n){return new Promise(function(i,r){fetch(w.rentInsert,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:e,item_id:t,start_date:a,end_date:n})}).then(function(e){return e.json()}).then(function(e){i(e)}).catch(function(e){r(e)})})}},{key:"rentModify",value:function(e,t,a,n){return new Promise(function(i,r){fetch(w.rentModify,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:e,item_id:t,start_date:a,end_date:n})}).then(function(e){return e.json()}).then(function(e){i(e)}).catch(function(e){r(e)})})}},{key:"rentReturn",value:function(e){return new Promise(function(t,a){fetch(w.rentReturn,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:e})}).then(function(e){return e.json()}).then(function(e){t(e)}).catch(function(e){a(e)})})}},{key:"rentReturnReserved",value:function(e){return new Promise(function(t,a){fetch(w.rentReturnReserved,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:e})}).then(function(e){return e.json()}).then(function(e){t(e)}).catch(function(e){a(e)})})}},{key:"reservationInsert",value:function(e,t,a,n){return new Promise(function(i,r){fetch(w.reserveInsert,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({user_id:e,item_id:t,reservation_start:a,reservation_end:n})}).then(function(e){return e.json()}).then(function(e){i(e)}).catch(function(){r("Reserving item failed")})})}},{key:"reservationModify",value:function(e,t,a,n,i){return new Promise(function(r,s){fetch(w.reserveModify,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:e,user_id:t,item_id:a,reservation_start:n,reservation_end:i})}).then(function(e){return e.json()}).then(function(e){r(e)}).catch(function(){s("Modifying reservation item failed")})})}},{key:"reservationDelete",value:function(e){return new Promise(function(t,a){fetch(w.reserveDelete,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:e})}).then(function(e){return e.json()}).then(function(e){t(e)}).catch(function(){a("Deleting reservation failed")})})}}]),e}()),C=function(e){function t(){return Object(o.a)(this,t),Object(d.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"deleteRow",value:function(){var e=this;O.deleteItem(this.props.id).then(function(){e.props.onItemChangeRemote()})}},{key:"deleteReservation",value:function(){var e=this;"undefined"!==typeof this.props.rowData.id&&O.reservationDelete(this.props.rowData.id).then(function(){e.props.onItemChangeRemote()})}},{key:"returnRent",value:function(){var e=this;"undefined"!==typeof this.props.rowData.id&&O.rentReturn(this.props.rowData.id).then(function(){e.props.onItemChangeRemote()})}},{key:"returnRentReserved",value:function(){var e=this;"undefined"!==typeof this.props.rowData.id&&O.rentReturnReserved(this.props.rowData.id).then(function(){e.props.onItemChangeRemote()})}},{key:"isInHistory",value:function(e){var t;return(t=(t=new Date(e.reservation_end)).setHours(t.getHours()+t.getTimezoneOffset()/60))<new Date(Date.now())}},{key:"render",value:function(){var e=this;return this.props.admin?this.props.rentView?i.a.createElement("td",{className:"dropleft"},i.a.createElement("img",{src:"./menu32.png",alt:"Item menu","data-toggle":"dropdown"}),i.a.createElement("div",{className:"dropdown-menu"},i.a.createElement("button",{className:"dropdown-item",type:"button",onClick:function(){e.props.toggleModalRemote({id:e.props.id,itemInputView:!0,reservationInput:!0,rentInput:!0,rowData:e.props.rowData,rent_id:e.props.rent_id,rentView:!0})}},"View"),i.a.createElement("div",{hidden:this.isInHistory(this.props.rowData)},i.a.createElement("button",{className:"dropdown-item",type:"button",onClick:function(){e.props.toggleModalRemote({id:e.props.id,reservationInput:!0,rentInput:!0,rowData:e.props.rowData,rent_id:e.props.rent_id,rentView:!0})}},"Change reservation / Rent"),null!==this.props.rowData.start_date?i.a.createElement("button",{className:"dropdown-item",type:"button",onClick:function(){e.returnRentReserved()}},"Return to Reserved"):"",null!==this.props.rowData.start_date?i.a.createElement("button",{className:"dropdown-item",type:"button",onClick:function(){e.returnRent()}},"Return to Stock"):"",null===this.props.rowData.start_date?i.a.createElement("button",{className:"dropdown-item",type:"button",onClick:function(){e.deleteReservation()}},"Return to Stock"):""))):i.a.createElement("td",{className:"dropleft"},i.a.createElement("img",{src:"./menu32.png",alt:"Item menu","data-toggle":"dropdown"}),i.a.createElement("div",{className:"dropdown-menu"},i.a.createElement("button",{className:"dropdown-item",type:"button",onClick:function(){e.props.toggleModalRemote({id:e.props.id,itemInputView:!0,rowData:e.props.rowData,reserveView:!0})}},"View"),i.a.createElement("button",{className:"dropdown-item",type:"button",onClick:function(){e.props.toggleModalRemote({id:e.props.id,itemInput:!0,reservationInput:!0,reserveView:!0,rowData:e.props.rowData})}},"Modify Item / Reserve"),i.a.createElement("button",{className:"dropdown-item",type:"button",onClick:function(){e.deleteRow()}},"Delete"))):this.props.rentView?i.a.createElement("td",{className:"dropleft"},i.a.createElement("img",{src:"./menu32.png",alt:"Item menu","data-toggle":"dropdown"}),i.a.createElement("div",{className:"dropdown-menu"},i.a.createElement("button",{id:"View",hidden:null===this.props.rowData.end_date&&!this.isInHistory(this.props.rowData),className:"dropdown-item",type:"button",onClick:function(){e.props.toggleModalRemote({id:e.props.id,rentInputView:!0,reservationInput:!0,rowData:e.props.rowData,rent_id:e.props.rent_id,rentView:!0})}},"View"),i.a.createElement("button",{id:"Change",hidden:"undefined"!==typeof this.props.rowData.start_date&&null!==this.props.rowData.start_date||this.isInHistory(this.props.rowData),className:"dropdown-item",type:"button",onClick:function(){e.props.toggleModalRemote({id:e.props.id,rentInputView:!0,reservationInput:!0,rowData:e.props.rowData,rent_id:e.props.rent_id,rentView:!0})}},"Change"),i.a.createElement("button",{id:"deleteReservation",hidden:"undefined"!==typeof this.props.rowData.start_date&&null!==this.props.rowData.start_date||this.isInHistory(this.props.rowData),className:"dropdown-item",type:"button",onClick:function(){e.deleteReservation()}},"Remove Reservation"))):i.a.createElement("td",{className:"dropleft"},i.a.createElement("img",{src:"./menu32.png",alt:"Item menu","data-toggle":"dropdown"}),i.a.createElement("div",{className:"dropdown-menu"},i.a.createElement("button",{className:"dropdown-item",type:"button",onClick:function(){e.props.toggleModalRemote({id:e.props.id,itemInputView:!0,rowData:e.props.rowData,reserveView:!0})}},"View"),i.a.createElement("button",{className:"dropdown-item",type:"button",onClick:function(){e.props.toggleModalRemote({id:e.props.id,reservationInput:!0,rowData:e.props.rowData,reserveView:!0})}},"Reserve")))}}]),t}(n.Component),N=function(e){function t(){return Object(o.a)(this,t),Object(d.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return this.props.rentView?i.a.createElement("tr",null,i.a.createElement(j,{data:this.props.rowData.serial}),i.a.createElement(j,{data:this.props.rowData.name}),i.a.createElement(j,{data:this.props.rowData.brand}),i.a.createElement(j,{data:this.props.rowData.model}),i.a.createElement(j,{data:this.props.rowData.address}),i.a.createElement(j,{data:this.props.rowData.owner}),i.a.createElement(C,{rowData:this.props.rowData,admin:this.props.admin,onItemChangeRemote:this.props.onItemChangeRemote,toggleModalRemote:this.props.toggleModalRemote,id:this.props.rowData.serial})):i.a.createElement("tr",null,i.a.createElement(j,{data:this.props.type}),i.a.createElement(j,{data:this.props.rowData.username}),i.a.createElement(j,{data:this.props.rowData.serial}),i.a.createElement(j,{data:this.props.rowData.name}),i.a.createElement(j,{data:this.props.rowData.owner}),i.a.createElement(j,{data:this.props.start_date}),i.a.createElement(j,{data:this.props.end_date}),i.a.createElement(C,{type:this.props.type,rowData:this.props.rowData,rentView:!0,admin:this.props.admin,onItemChangeRemote:this.props.onItemChangeRemote,toggleModalRemote:this.props.toggleModalRemote,id:this.props.rowData.serial,rent_id:this.props.rowData.id}))}}]),t}(n.Component),I=function(e){function t(){return Object(o.a)(this,t),Object(d.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return this.props.rentView?i.a.createElement("tr",null,i.a.createElement(S,{data:"Serial"}),i.a.createElement(S,{data:"Name"}),i.a.createElement(S,{data:"Brand"}),i.a.createElement(S,{data:"Model"}),i.a.createElement(S,{data:"Location"}),i.a.createElement(S,{data:"Owner"}),i.a.createElement(S,{data:""})):i.a.createElement("tr",null,i.a.createElement(S,{data:"Status"}),i.a.createElement(S,{data:"Username"}),i.a.createElement(S,{data:"Serial"}),i.a.createElement(S,{data:"Name"}),i.a.createElement(S,{data:"Owner"}),i.a.createElement(S,{data:"Start Date"}),i.a.createElement(S,{data:"End Date"}),i.a.createElement(S,{data:""}))}}]),t}(n.Component),j=function(e){function t(){return Object(o.a)(this,t),Object(d.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return i.a.createElement("td",null,this.props.data)}}]),t}(n.Component),S=function(e){function t(){return Object(o.a)(this,t),Object(d.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return i.a.createElement("th",{scope:"col"},this.props.data)}}]),t}(n.Component),k=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(d.a)(this,Object(c.a)(t).call(this,e))).state={data:[]},a.formatDate=a.formatDate.bind(Object(m.a)(Object(m.a)(a))),a.updateRows=a.updateRows.bind(Object(m.a)(Object(m.a)(a))),a.props.updateTableRowsGetSet(a.updateRows),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.updateRows()}},{key:"updateRows",value:function(e,t,a,n,i,r,s,o){var l=this;this.props.rentView?O.fetchItems(e,t,a,n,i,r,s,o).then(function(e){l.setState({data:e})}).catch(function(e){console.log(e)}):this.props.auth.admin?O.fetchAllRents(this.props.search).then(function(e){l.setState({data:e})}).catch(function(e){console.log(e)}):O.fetchUserRents(this.props.auth.username).then(function(e){l.setState({data:e})}).catch(function(e){console.log(e)})}},{key:"formatDate",value:function(e,t){var a="",n=function(e){return e.slice(8,10)+e.slice(4,8)+e.slice(0,4)+" | "+e.slice(11,16)};return null!==e.reservation_start&&"undefined"!==typeof e.reservation_start&&(a=t?null!==e.start_date?n(e.start_date):n(e.reservation_start):null!==e.end_date?n(e.end_date):n(e.reservation_end)),a}},{key:"typeText",value:function(e){return null===e.start_date?"admin"===e.username?i.a.createElement("span",{className:"badge badge-info"},"Maintenance"):this.isHistory(e.reservation_end)?i.a.createElement("span",{className:"badge badge-secondary"},"Reserved"):i.a.createElement("span",{className:"badge badge-warning"},"Reserved"):this.isHistory(e.end_date)?i.a.createElement("span",{className:"badge badge-secondary"},"Rented"):i.a.createElement("span",{className:"badge badge-success"},"Rented")}},{key:"isHistory",value:function(e){var t=new Date(e);return(t=t.setHours(t.getHours()+t.getTimezoneOffset()/60))<new Date(Date.now())}},{key:"render",value:function(){var e=this,t=this.state.data.map(function(t,a){return i.a.createElement(N,{type:e.typeText(t),start_date:e.formatDate(t,!0),end_date:e.formatDate(t,!1),rentView:e.props.rentView,onItemChangeRemote:e.props.onItemChangeRemote,admin:e.props.auth.admin,toggleModalRemote:e.props.toggleModalRemote,returnHeader:!1,key:a,rowData:t})});return"undefined"!==typeof this.state.data[0]&&this.props.rentView?i.a.createElement("div",{className:"ItemTable"},i.a.createElement("table",{className:"table table-responsive-sm table-striped table-dark"},i.a.createElement("thead",null,i.a.createElement(I,{rentView:this.props.rentView})),i.a.createElement("tbody",null,t))):"undefined"===typeof this.state.data[0]?i.a.createElement("div",{className:"ItemTable"},i.a.createElement("div",null,i.a.createElement("span",{className:"h3 text-white"},"No items found!"))):i.a.createElement("div",{className:"ItemTable"},i.a.createElement("table",{className:"table table-responsive-sm table-striped table-dark"},i.a.createElement("thead",null,i.a.createElement(I,{rentView:this.props.rentView})),i.a.createElement("tbody",null,t)))}}]),t}(n.Component),T=a(23),M=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(d.a)(this,Object(c.a)(t).call(this,e))).handleChange=function(e){a.setState(Object(g.a)({},e.target.id,e.target.value))},a.state={id:"",rent_id:"",inputName:"",inputBrand:"",inputModel:"",inputInfo:"",inputAddress:"",inputCategory:"",inputOwner:"",inputCategoryDd:"",inputAddressDd:"",inputOwnerDd:"",inputReservationStartDate:"",inputReservationEndDate:"",inputReservationStartTime:"",inputReservationEndTime:"",inputRentStartDate:"",inputRentStartTime:"",inputRentEndDate:"",inputRentEndTime:"",modal:!1,backdrop:!0,addMode:!1,modalHeader:"",reserveView:!1,rentView:!1,itemInputView:!1,itemInput:!1,reservationInput:!1,rentInput:!1,hideDate:!1,failText:"",reservationId:"",reservationFail:!1,reservationModifyFail:!1,reservationDeleteFail:!1,rented:!1,rentFail:!1,startDate:"",newItemFail:!1,rowData:{},dateNow:a.dateNow(),timeNow:a.timeNow(),isHistory:!1},a.onChangeState(),a.dateNow=a.dateNow.bind(Object(m.a)(Object(m.a)(a))),a.timeNow=a.timeNow.bind(Object(m.a)(Object(m.a)(a))),a.rentItem=a.rentItem.bind(Object(m.a)(Object(m.a)(a))),a.rentModify=a.rentModify.bind(Object(m.a)(Object(m.a)(a))),a.reservationModify=a.reservationModify.bind(Object(m.a)(Object(m.a)(a))),a.reserveItem=a.reserveItem.bind(Object(m.a)(Object(m.a)(a))),a.toggle=a.toggle.bind(Object(m.a)(Object(m.a)(a))),a.addItem=a.addItem.bind(Object(m.a)(Object(m.a)(a))),a.saveChanges=a.saveChanges.bind(Object(m.a)(Object(m.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"onChangeState",value:function(){this.props.toggleModal(this.toggle.bind(this))}},{key:"resetModal",value:function(){this.setState({id:"",rent_id:"",inputName:"",inputBrand:"",inputModel:"",inputInfo:"",inputAddress:"",inputCategory:"",inputOwner:"",inputCategoryDd:"",inputAddressDd:"",inputOwnerDd:"",inputReservationStartDate:"",inputReservationEndDate:"",inputReservationStartTime:"",inputReservationEndTime:"",inputRentStartDate:"",inputRentStartTime:"",inputRentEndDate:"",inputRentEndTime:"",modal:!this.state.modal,backdrop:!0,addMode:!1,modalHeader:"",reserveView:!1,rentView:!1,itemInputView:!1,itemInput:!1,reservationInput:!1,rentInput:!1,hideDate:!1,failText:"",reservationId:"",reservationFail:!1,reservationModifyFail:!1,reservationDeleteFail:!1,rented:!1,rentFail:!1,startDate:"",newItemFail:!1,rowData:{},dateNow:this.dateNow(),timeNow:this.timeNow(),isHistory:!1})}},{key:"dateOrTime",value:function(e,t){return"date"===e?t.split("T")[0]:t.split("T")[1].split(".")[0].slice(0,5)}},{key:"toggle",value:function(e){var t=this;new Promise(function(a){if("undefined"!==typeof e){var n,i="";i="undefined"!==typeof e.addMode&&null!==e.addMode?"Add new item: ":"undefined"!==typeof e.rentInput&&null!==e.rentInput?"Rent / Reservation info for serial: ":"undefined"!==typeof e.reservationInput&&null!==e.reservationInput?"Reserve item: ":"undefined"!==typeof e.itemInputView&&null!==e.itemInputView?"Viewing item: ":"Editing item: ";var r=!1,s=!1;"undefined"!==typeof e.rowData&&("undefined"!==typeof e.rowData.start_date&&null!==e.rowData.start_date?(s=!0,n=(n=new Date(e.rowData.end_date)).setHours(n.getHours()+n.getTimezoneOffset()/60)):(s=!1,n=(n=new Date(e.rowData.reservation_end)).setHours(n.getHours()+n.getTimezoneOffset()/60)),"undefined"!==typeof n&&(r=new Date(Date.now())>n&&!0));var o="undefined"!==typeof e.rowData;t.setState({id:"undefined"!==typeof e.id?e.id:"",rent_id:o&&"undefined"!==typeof e.rowData.rent_id?e.rent_id:"",inputName:o&&"undefined"!==typeof e.rowData.name?e.rowData.name:"",inputBrand:o&&"undefined"!==typeof e.rowData.brand?e.rowData.brand:"",inputModel:o&&"undefined"!==typeof e.rowData.model?e.rowData.model:"",inputInfo:o&&"undefined"!==typeof e.rowData.info?e.rowData.info:"",inputAddress:"",inputCategory:"",inputOwner:"",inputAddressDd:o&&"undefined"!==typeof e.rowData.address?e.rowData.address:"",inputCategoryDd:o&&"undefined"!==typeof e.rowData.category?e.rowData.category:"",inputOwnerDd:o&&"undefined"!==typeof e.rowData.owner?e.rowData.owner:"",inputReservationStartDate:o&&"undefined"!==typeof e.rowData.reservation_start&&null!==e.rowData.reservation_start?t.dateOrTime("date",e.rowData.reservation_start):"",inputReservationEndDate:o&&"undefined"!==typeof e.rowData.reservation_end&&null!==e.rowData.reservation_end?t.dateOrTime("date",e.rowData.reservation_end):"",inputReservationStartTime:o&&"undefined"!==typeof e.rowData.reservation_start&&null!==e.rowData.reservation_start?t.dateOrTime("",e.rowData.reservation_start):"",inputReservationEndTime:o&&"undefined"!==typeof e.rowData.reservation_end&&null!==e.rowData.reservation_end?t.dateOrTime("",e.rowData.reservation_end):"",inputRentStartDate:o&&"undefined"!==typeof e.rowData.start_date&&null!==e.rowData.start_date?e.rowData.start_date.split("T")[0]:"",inputRentEndDate:o&&"undefined"!==typeof e.rowData.end_date&&null!==e.rowData.end_date?e.rowData.end_date.split("T")[0]:"",inputRentStartTime:o&&"undefined"!==typeof e.rowData.start_date&&null!==e.rowData.start_date?e.rowData.start_date.split("T")[1].split(".")[0].slice(0,5):"",inputRentEndTime:o&&"undefined"!==typeof e.rowData.end_date&&null!==e.rowData.end_date?e.rowData.end_date.split("T")[1].split(".")[0].slice(0,5):"",modal:!t.state.modal,backdrop:!0,addMode:"undefined"!==typeof e.addMode&&e.addMode,modalHeader:i,itemInputView:"undefined"!==typeof e.itemInputView&&e.itemInputView,rentInput:"undefined"!==typeof e.rentInput&&e.rentInput,reservationInput:"undefined"!==typeof e.reservationInput&&e.reservationInput,reserveView:"undefined"!==typeof e.reserveView&&e.reserveView,rentView:"undefined"!==typeof e.rentView&&e.rentView,itemInput:"undefined"!==typeof e.itemInput&&e.itemInput,hideDate:!1,failText:"",reservationId:"",reservationFail:!1,reservationModifyFail:!1,reservationDeleteFail:!1,rented:s,rentFail:!1,startDate:"",newItemFail:!1,rowData:"undefined"!==typeof e.rowData?e.rowData:{},dateNow:t.dateNow(),timeNow:t.timeNow(),isHistory:r})}else t.resetModal()}).then(function(){!t.state.addMode&&t.state.inputName.length>0&&t.setState({inputName:"",inputBrand:"",inputModel:"",inputInfo:"",inputAddress:"",inputOwner:"",inputCategory:"",inputAddressDd:"",inputOwnerDd:"",inputCategoryDd:"",newItemFail:!1})}).catch(function(e){console.log(e)})}},{key:"saveChanges",value:function(){var e=this;this.checkInput().then(function(t){O.modifyItem(e.state.id,e.state.inputName,e.state.inputBrand,e.state.inputModel,e.state.inputInfo,t.address,t.owner,t.category).then(function(){e.toggle({})}).then(function(){e.props.onItemChangeRemote()}).catch(function(){console.log("Something failed in saveChanges()")})})}},{key:"validateInput",value:function(){var e=!0;return""===this.state.inputName&&(e=!1),""===this.state.inputOwner&&""===this.state.inputOwnerDd&&(e=!1),""===this.state.inputAddress&&""===this.state.inputAddressDd&&(e=!1),e}},{key:"addItem",value:function(){var e=this;this.validateInput()?this.checkInput().then(function(t){O.insertItem(e.state.inputName,e.state.inputBrand,e.state.inputModel,e.state.inputInfo,t.address,t.owner,t.category).then(function(){e.setState({newItemFail:!1}),e.toggle({})}).then(function(){e.props.onItemChangeRemote()}).catch(function(t){e.setState({newItemFail:!0}),console.log("Something failed in addItem() "+t)})}):this.setState({newItemFail:!0})}},{key:"reserveItem",value:function(){var e=this;this.compareDate(this.state.inputReservationStartDate,this.state.inputReservationEndDate,this.state.inputReservationStartTime,this.state.inputReservationEndTime)>-1&&""!==this.state.inputReservationStartDate&&""!==this.state.inputReservationEndDate&&""!==this.state.inputReservationStartTime&&""!==this.state.inputReservationEndTime?O.reservationInsert(this.props.auth.userId,this.state.id,this.state.inputReservationStartDate+" "+this.state.inputReservationStartTime+":00",this.state.inputReservationEndDate+" "+this.state.inputReservationEndTime+":00").then(function(t){t.success?(e.setState({reservationFail:!1}),e.toggle({})):"undefined"!==typeof t.row?e.setState({reservationFail:!0,failText:t.message+"          "+e.formatDate(t.row[0].reservation_start)+" <-> "+e.formatDate(t.row[0].reservation_end)}):e.setState({reservationFail:!0,failText:t.message})}).then(function(){e.props.onItemChangeRemote()}).catch(function(e){console.log(e)}):this.setState({reservationFail:!0,failText:"Error! Check what you inserted is right!"})}},{key:"reservationModify",value:function(){var e=this;"undefined"!==typeof this.state.rowData.id&&""!==this.state.inputReservationStartDate&&""!==this.state.inputReservationEndDate&&""!==this.state.inputReservationStartTime&&""!==this.state.inputReservationEndTime&&this.compareDate(this.state.inputReservationStartDate,this.state.inputReservationEndDate,this.state.inputReservationStartTime,this.state.inputReservationEndTime)>-1?O.reservationModify(this.state.rowData.id,this.props.auth.userId,this.state.id,this.state.inputReservationStartDate+" "+this.state.inputReservationStartTime+":00",this.state.inputReservationEndDate+" "+this.state.inputReservationEndTime+":00").then(function(t){t.success?(e.setState({reservationFail:!1}),e.toggle({})):"undefined"!==typeof t?e.setState({reservationFail:!0,failText:t.message+"          "+e.formatDate(t.row[0].reservation_start)+" <-> "+e.formatDate(t.row[0].reservation_end)}):e.setState({reservationFail:!0,failText:t.message})}).then(function(){e.props.onItemChangeRemote()}).catch(function(t){e.setState({reservationFail:!0}),console.log(t)}):this.setState({reservationFail:!0,failText:"Error! Check what you inserted is right!"})}},{key:"rentItem",value:function(){var e=this;console.log(this.dateNow()),console.log(this.state.inputReservationStartDate),console.log(this.dateNow()>=this.state.inputReservationStartDate),this.dateNow()>=this.state.inputReservationStartDate?"undefined"!==typeof this.state.rowData.id&&""!==this.state.inputRentStartDate&&""!==this.state.inputRentEndDate&&""!==this.state.inputRentStartTime&&""!==this.state.inputRentEndTime&&this.compareDate(this.state.inputRentStartDate,this.state.inputRentEndDate,this.state.inputRentStartTime,this.state.inputRentEndTime)>-1?O.rentInsert(this.state.rowData.id,this.state.id,this.state.inputRentStartDate+" "+this.state.inputRentStartTime+":00",this.state.inputRentEndDate+" "+this.state.inputRentEndTime+":00").then(function(t){t.success?(e.setState({rentFail:!1}),e.toggle({})):"undefined"!==typeof t?e.setState({rentFail:!0,failText:t.message+"          "+e.formatDate(t.row[0].reservation_start)+" <-> "+e.formatDate(t.row[0].reservation_end)}):e.setState({rentFail:!0,failText:t.message})}).then(function(){e.props.onItemChangeRemote()}).catch(function(e){console.log(e)}):this.setState({rentFail:!0}):this.setState({rentFail:!0,failText:"Reservation start date is in the future! Change reservation start date to be able to rent this item!"})}},{key:"rentModify",value:function(){var e=this;"undefined"!==typeof this.state.rowData.id&&""!==this.state.inputRentStartDate&&""!==this.state.inputRentEndDate&&""!==this.state.inputRentStartTime&&""!==this.state.inputRentEndTime&&this.compareDate(this.state.inputRentStartDate,this.state.inputRentEndDate,this.state.inputRentStartTime,this.state.inputRentEndTime)>-1?O.rentModify(this.state.rowData.id,this.state.id,this.state.inputRentStartDate+" "+this.state.inputRentStartTime+":00",this.state.inputRentEndDate+" "+this.state.inputRentEndTime+":00").then(function(t){t.success?(e.setState({rentFail:!1}),e.toggle({})):"undefined"!==typeof t?e.setState({rentFail:!0,failText:t.message+"          "+e.formatDate(t.row[0].reservation_start)+" <-> "+e.formatDate(t.row[0].reservation_end)}):e.setState({rentFail:!0,failText:t.message})}).then(function(){e.props.onItemChangeRemote()}).catch(function(e){console.log(e)}):this.setState({rentFail:!0})}},{key:"formatDate",value:function(e){return e.slice(8,10)+e.slice(4,8)+e.slice(0,4)+" | "+e.slice(11,16)}},{key:"formatDateReverse",value:function(e,t){return e+"T"+t+":00"}},{key:"dateNow",value:function(){return Date.prototype.addTimeOffset=function(){return this.setHours(this.getHours()+(new Date).getTimezoneOffset()/60*-1),this},new Date(Date.now()).addTimeOffset().toISOString().slice(0,10)}},{key:"timeNow",value:function(){return Date.prototype.addTimeOffset=function(){return this.setHours(this.getHours()+(new Date).getTimezoneOffset()/60*-1),this},new Date(Date.now()).addTimeOffset().toISOString().slice(11,14)+"00"}},{key:"compareDate",value:function(e,t,a,n){var i=new Date(this.formatDateReverse(e,a)),r=new Date(this.formatDateReverse(t,n));return i<r?1:i===r?0:-1}},{key:"checkInput",value:function(){var e=this;return new Promise(function(t){var a={};""!==e.state.inputAddress?a.address=e.state.inputAddress:""!==e.state.inputAddressDd?a.address=e.state.inputAddressDd:a.address=null,""!==e.state.inputCategory?a.category=e.state.inputCategory:""!==e.state.inputCategoryDd?a.category=e.state.inputCategoryDd:a.category=null,""!==e.state.inputOwner?a.owner=e.state.inputOwner:""!==e.state.inputOwnerDd?a.owner=e.state.inputOwnerDd:a.owner=null,t(a)})}},{key:"adminButtons",value:function(){return this.state.itemInputView?null:this.state.rentView?i.a.createElement("div",null,i.a.createElement("div",{className:"form-row",hidden:this.state.rented},i.a.createElement("div",{className:"col-md-12"},i.a.createElement(R.a,{color:"warning btn-block m-0",onClick:this.reservationModify},"admin"===this.state.rowData.username?"Save maintenance changes":"Save reservation changes"))),i.a.createElement("div",{className:"form-row",hidden:"admin"===this.state.rowData.username},i.a.createElement("div",{className:"col-md-12"},i.a.createElement(R.a,{color:"success btn-block m-0",onClick:this.state.rented?this.rentModify:this.rentItem},this.state.rented?"Change Rent":"Rent Item")))):i.a.createElement("div",{className:"form-row"},i.a.createElement("div",{className:"col-md-12"},i.a.createElement(R.a,{className:"btn-block m-0",color:"warning",onClick:this.reserveItem},"Reserve for Maintenance")),i.a.createElement("div",{className:"col-md-12"},i.a.createElement(R.a,{color:"success btn-block m-0",onClick:this.saveChanges},"Save changes")))}},{key:"userButtons",value:function(){return this.state.itemInputView&&!this.state.reservationInput?null:this.state.reservationInput&&this.state.rentView?i.a.createElement("div",{className:"form-row"},i.a.createElement("div",{className:"col-md-12"},i.a.createElement(R.a,{color:"success btn-block m-0",onClick:this.reservationModify},"Save changes"))):i.a.createElement("div",{className:"form-row"},i.a.createElement("div",{className:"col-md-12"},i.a.createElement(R.a,{className:"btn-block m-0",color:"success",onClick:this.reserveItem},"Reserve")))}},{key:"addModeBtn",value:function(){return i.a.createElement("div",{className:"form-row"},i.a.createElement("div",{className:"col-md-12"},i.a.createElement(R.a,{color:"success btn-block m-0",onClick:this.addItem},"Add new")))}},{key:"disableItemInput",value:function(){return!(!this.state.itemInputView&&this.props.auth.admin&&!this.state.rentInput)}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(R.h,{isOpen:this.state.modal,toggle:function(){e.toggle()},className:this.props.className},i.a.createElement(R.k,{toggle:function(t){Object(T.a)(t),e.toggle({})}},this.state.modalHeader,this.state.id),i.a.createElement(R.i,{className:"modal-body"},i.a.createElement(P,{content:this.state.failText,hidden:!this.state.reservationDeleteFail,cn:"alert alert-danger"}),i.a.createElement(P,{content:this.state.failText.length<16?"Rent failure! Check that your data correct and is in a right format(DD/MM/YYYY HH.MM)":this.state.failText,hidden:!this.state.rentFail,cn:"alert alert-danger"}),i.a.createElement(P,{content:this.state.failText.length<16?"Reservation failure! Check that your data correct and is in a right format(DD/MM/YYYY HH.MM)":this.state.failText,hidden:!this.state.reservationFail,cn:"alert alert-danger"}),i.a.createElement(P,{content:"Item add failure",hidden:!this.state.newItemFail,cn:"alert alert-danger"}),i.a.createElement("form",null,i.a.createElement("div",{hidden:this.state.addMode||this.state.itemInputView&&this.state.reserveView&&!this.state.reservationInput},i.a.createElement("div",null,i.a.createElement("div",{className:"form-row"},i.a.createElement("div",{className:"form-group col-md-6"},i.a.createElement("label",{htmlFor:"inputReservationStartDate"},"Reservation Start Date"),i.a.createElement("input",{type:"date",className:"form-control",id:"inputReservationStartDate",onChange:this.handleChange,min:this.state.dateNow,value:this.state.inputReservationStartDate,disabled:this.state.rented||this.state.itemInputView||this.state.isHistory})),i.a.createElement("div",{className:"form-group col-md-6"},i.a.createElement("label",{htmlFor:"inputReservationStartTime"},"Reservation Start Time"),i.a.createElement("input",{type:"time",className:"form-control",id:"inputReservationStartTime",onChange:this.handleChange,min:this.state.rentInput?"":this.state.timeNow,value:this.state.inputReservationStartTime,disabled:this.state.rented||this.state.itemInputView||this.state.isHistory}))),i.a.createElement("div",{className:"form-row",hidden:!(this.state.reservationInput||this.state.rentInput)},i.a.createElement("div",{className:"form-group col-md-6"},i.a.createElement("label",{htmlFor:"inputReservationEndDate"},"Reservation End Date"),i.a.createElement("input",{type:"date",className:"form-control",id:"inputReservationEndDate",onChange:this.handleChange,min:this.state.inputReservationStartDate,value:this.state.inputReservationEndDate,disabled:this.state.rented||this.state.itemInputView||this.state.isHistory})),i.a.createElement("div",{className:"form-group col-md-6"},i.a.createElement("label",{htmlFor:"inputReservationEndTime"},"Reservation End Time"),i.a.createElement("input",{type:"time",className:"form-control",id:"inputReservationEndTime",onChange:this.handleChange,value:this.state.inputReservationEndTime,disabled:this.state.rented||this.state.itemInputView||this.state.isHistory}))),i.a.createElement("hr",null)),i.a.createElement("div",{hidden:"admin"===this.state.rowData.username||""===this.state.inputRentStartDate&&!this.props.auth.admin||""===this.state.inputRentStartDate&&this.props.auth.admin&&this.state.itemInputView||this.state.reserveView},i.a.createElement("div",{className:"form-row"},i.a.createElement("div",{className:"form-group col-md-6"},i.a.createElement("label",{htmlFor:"inputRentStartDate"},"Rent Start Date"),i.a.createElement("input",{type:"date",className:"form-control",id:"inputRentStartDate",onChange:this.handleChange,min:this.state.inputReservationStartDate,value:this.state.inputRentStartDate,disabled:this.state.rented||!this.props.auth.admin||this.state.isHistory||this.state.itemInputView})),i.a.createElement("div",{className:"form-group col-md-6"},i.a.createElement("label",{htmlFor:"inputRentStartTime"},"Rent Start Time"),i.a.createElement("input",{type:"time",className:"form-control",id:"inputRentStartTime",onChange:this.handleChange,min:this.state.inputReservationStartTime,value:this.state.inputRentStartTime,disabled:this.state.rented||!this.props.auth.admin||this.state.isHistory||this.state.itemInputView}))),i.a.createElement("div",{className:"form-row"},i.a.createElement("div",{className:"form-group col-md-6"},i.a.createElement("label",{htmlFor:"inputRentEndDate"},"Rent End Date"),i.a.createElement("input",{type:"date",className:"form-control",id:"inputRentEndDate",onChange:this.handleChange,min:this.state.inputRentStartDate,value:this.state.inputRentEndDate,disabled:this.state.rented&&!this.props.auth.admin||this.state.isHistory||this.state.itemInputView})),i.a.createElement("div",{className:"form-group col-md-6"},i.a.createElement("label",{htmlFor:"inputRentEndTime"},"Rent End Time"),i.a.createElement("input",{type:"time",className:"form-control",id:"inputRentEndTime",onChange:this.handleChange,value:this.state.inputRentEndTime,disabled:this.state.rented&&!this.props.auth.admin||this.state.isHistory||this.state.itemInputView}))))),i.a.createElement("div",null,i.a.createElement("div",{className:"form-row"},i.a.createElement("div",{className:"form-group col-md-4"},i.a.createElement("label",{htmlFor:"inputName"},"Name"),i.a.createElement("input",{type:"text",className:"form-control",id:"inputName",placeholder:"Name",onChange:this.handleChange,value:this.state.inputName,disabled:this.disableItemInput()})),i.a.createElement("div",{className:"form-group col-md-4"},i.a.createElement("label",{htmlFor:"inputBrand"},"Brand"),i.a.createElement("input",{type:"text",className:"form-control",id:"inputBrand",placeholder:"Brand",onChange:this.handleChange,value:this.state.inputBrand,disabled:this.disableItemInput()})),i.a.createElement("div",{className:"form-group col-md-4"},i.a.createElement("label",{htmlFor:"inputModel"},"Model"),i.a.createElement("input",{type:"text",className:"form-control",id:"inputModel",placeholder:"Model",onChange:this.handleChange,value:this.state.inputModel,disabled:this.disableItemInput()}))),i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"inputInfo"},"Info"),i.a.createElement("textarea",{className:"form-control",id:"inputInfo",placeholder:"Short description...",onChange:this.handleChange,value:this.state.inputInfo,disabled:this.disableItemInput()})),i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"inputAddress"},"Add new address"),i.a.createElement("input",{value:this.state.inputAddress,type:"text",className:"form-control",id:"inputAddress",placeholder:"Address",onChange:this.handleChange,disabled:this.disableItemInput()})),i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"inputAddressDd"},"OR Choose address"),i.a.createElement("select",{value:!this.props.addMode&&this.state.inputAddressDd,onChange:this.handleChange,id:"inputAddressDd",className:"form-control",disabled:this.disableItemInput()},i.a.createElement("option",{value:""},"Address"),this.props.dropdownData.address)),i.a.createElement("div",{className:"form-row"},i.a.createElement("div",{className:"form-group col-md-5"},i.a.createElement("label",{htmlFor:"inputOwner"},"Add new owner"),i.a.createElement("input",{value:this.state.inputOwner,type:"text",className:"form-control",id:"inputOwner",onChange:this.handleChange,disabled:this.disableItemInput()})),i.a.createElement("div",{className:"form-group col-md-2"},i.a.createElement("p",null,"OR")),i.a.createElement("div",{className:"form-group col-md-5"},i.a.createElement("label",{htmlFor:"inputOwnerDd"},"Choose owner"),i.a.createElement("select",{value:this.props.addMode?"":this.state.inputOwnerDd,onChange:this.handleChange,id:"inputOwnerDd",className:"form-control",disabled:this.disableItemInput()},i.a.createElement("option",{value:""},"Owner"),this.props.dropdownData.owner))),i.a.createElement("div",{className:"form-row"},i.a.createElement("div",{className:"form-group col-md-5"},i.a.createElement("label",{htmlFor:"inputCategory"},"Add new category"),i.a.createElement("input",{value:this.state.inputCategory,type:"text",className:"form-control",id:"inputCategory",onChange:this.handleChange,disabled:this.disableItemInput()})),i.a.createElement("div",{className:"form-group col-md-2"},i.a.createElement("p",null,"OR")),i.a.createElement("div",{className:"form-group col-md-5"},i.a.createElement("label",{htmlFor:"inputCategoryDd"},"Choose category"),i.a.createElement("select",{value:!this.props.addMode&&this.state.inputCategoryDd,onChange:this.handleChange,id:"inputCategoryDd",className:"form-control",disabled:this.disableItemInput()},i.a.createElement("option",{value:""},"Category"),this.props.dropdownData.category)))),this.props.auth.admin&&this.state.addMode?this.addModeBtn():"",this.props.auth.admin&&!this.state.addMode&&!this.state.isHistory&&this.adminButtons(),this.props.auth.admin||this.state.rented||this.state.isHistory?"":this.userButtons()))))}}]),t}(n.Component),P=function(e){return i.a.createElement("div",{hidden:e.hidden,className:e.cn,role:"alert"},e.content)},_=M,F=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(d.a)(this,Object(c.a)(t).call(this,e))).handleChange=function(e){a.setState(Object(g.a)({},e.target.id,e.target.value))},a.state={modal:!1,oldPassword:"",userPassword:"",userPasswordConf:"",wrongPassword:!1,areCheckedOnce:!1},a.pwdError=a.pwdError.bind(Object(m.a)(Object(m.a)(a))),a.submitChange=a.submitChange.bind(Object(m.a)(Object(m.a)(a))),a.toggle=a.toggle.bind(Object(m.a)(Object(m.a)(a))),a.props.toggleUserModalGetSet(a.toggle),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"toggle",value:function(){this.setState({modal:!this.state.modal})}},{key:"submitChange",value:function(){var e=this;this.pwdError()||O.updatePassword(this.props.username,this.state.oldPassword,this.state.userPassword).then(function(t){t.success?e.toggle():e.setState({wrongPassword:!0})}).catch(function(e){console.log(e)})}},{key:"pwdError",value:function(){var e=!1;return this.state.userPassword!==this.state.userPasswordConf&&(e=!0),this.state.userPassword.length<4&&(e=!0),e}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(R.h,{isOpen:this.state.modal,toggle:this.toggle,className:this.props.className},i.a.createElement(R.k,{toggle:this.toggle},"User settings"),i.a.createElement(R.i,null,this.state.areCheckedOnce&&this.pwdError()?i.a.createElement("div",{className:"alert alert-warning",role:"alert"},"Passwords don't match OR are shorter than four characters."):"",this.state.wrongPassword&&i.a.createElement("div",{className:"alert alert-danger",role:"alert"},"Wrong ",i.a.createElement("strong",null,"old")," password!"),i.a.createElement(R.f,null,i.a.createElement(R.g,null,i.a.createElement("input",{type:"password",id:"oldPassword",onChange:this.handleChange,className:"form-control my-1 py-3",placeholder:"Old Password",required:!0,autoFocus:!0}),i.a.createElement("input",{type:"password",id:"userPassword",onChange:this.handleChange,className:"form-control my-1 py-3",placeholder:"New Password",required:!0}),i.a.createElement("input",{type:"password",id:"userPasswordConf",onChange:this.handleChange,className:"form-control my-1 py-3",placeholder:"New Password Confirmation",onBlur:function(){return e.setState({areCheckedOnce:!0})},required:!0})))),i.a.createElement(R.j,null,i.a.createElement(R.a,{className:"btn btn-success",color:"Success",onClick:this.submitChange},"Save changes")," ")))}}]),t}(i.a.Component),A=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(d.a)(this,Object(c.a)(t).call(this,e))).handleChange=function(e){a.setState(Object(g.a)({},e.target.id,e.target.value),function(){a.updateTableRowsRemoteSearch()})},a.state={authenticated:!1,toggleModalFunc:function(){},updateRowsFunc:function(){},isOpen:!1,collapsed:!0,inputIdNameBrandModel:"",inputAddressDd:"",inputOwnerDd:"",inputCategoryDd:"",dropdownData:{},updateTableRows:function(){},toggleUserModal:function(){},rentView:!0},a.toggleNavbar=a.toggleNavbar.bind(Object(m.a)(Object(m.a)(a))),a.updateDropdowns=a.updateDropdowns.bind(Object(m.a)(Object(m.a)(a))),a.toggleRentView=a.toggleRentView.bind(Object(m.a)(Object(m.a)(a))),a.onChangeModalGetSet=a.onChangeModalGetSet.bind(Object(m.a)(Object(m.a)(a))),a.onChangeModalRemote=a.onChangeModalRemote.bind(Object(m.a)(Object(m.a)(a))),a.updateTableRowsGetSet=a.updateTableRowsGetSet.bind(Object(m.a)(Object(m.a)(a))),a.onItemChangeRemote=a.onItemChangeRemote.bind(Object(m.a)(Object(m.a)(a))),a.toggleUserModalGetSet=a.toggleUserModalGetSet.bind(Object(m.a)(Object(m.a)(a))),a.toggleUserModalRemote=a.toggleUserModalRemote.bind(Object(m.a)(Object(m.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){this.updateDropdowns()}},{key:"onChangeModalRemote",value:function(e){this.state.toggleModalFunc(e)}},{key:"onChangeModalGetSet",value:function(e){this.setState({toggleModalFunc:e})}},{key:"onItemChangeRemote",value:function(){this.updateDropdowns(),this.state.updateTableRows()}},{key:"logout",value:function(){this.props.logout()}},{key:"toggleNavbar",value:function(){var e=this;this.setState({collapsed:!this.state.collapsed,inputIdNameBrandModel:"",inputAddressDd:"",inputOwnerDd:"",inputCategoryDd:""},function(){e.updateTableRowsRemote()})}},{key:"updateTableRowsGetSet",value:function(e){this.setState({updateTableRows:e})}},{key:"updateTableRowsRemote",value:function(){this.state.updateTableRows("","","","","","","","")}},{key:"updateTableRowsRemoteSearch",value:function(){this.state.updateTableRows(this.state.inputIdNameBrandModel,this.state.inputIdNameBrandModel,this.state.inputIdNameBrandModel,this.state.inputIdNameBrandModel,"",this.state.inputAddressDd,this.state.inputOwnerDd,this.state.inputCategoryDd)}},{key:"updateDropdowns",value:function(){var e=this,t={};O.getDropdownInfo().then(function(e){t.owner=e.owner.map(function(e,t){return i.a.createElement(V,{key:t,rowData:e.owner})}),t.address=e.address.map(function(e,t){return i.a.createElement(V,{key:t,rowData:e.address})}),t.category=e.category.map(function(e,t){return i.a.createElement(V,{key:t,rowData:e.category})})}).then(function(){e.setState({dropdownData:t})}).catch()}},{key:"toggleUserModalGetSet",value:function(e){this.setState({toggleUserModal:e})}},{key:"toggleUserModalRemote",value:function(){this.state.toggleUserModal()}},{key:"toggleRentView",value:function(e){var t=this;this.setState({inputIdNameBrandModel:"",inputAddressDd:"",inputOwnerDd:"",inputCategoryDd:"",rentView:e,collapsed:!0},function(){t.updateTableRowsRemote()})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"MainPage"},i.a.createElement("div",null,i.a.createElement(R.n,{color:"",dark:!0,className:"m-0 p-0"},i.a.createElement("div",{className:"row container-fluid mx-auto"},i.a.createElement("span",{className:"h1 font-weight-bold text-white float-md-left"},i.a.createElement("img",{className:"App-logo mx-0 p-0",src:"./gear64.ico",alt:""}),"RENTALIX"),i.a.createElement("div",{className:" menuItems"},i.a.createElement("img",{src:"./search.png",alt:"",onClick:this.toggleNavbar}),i.a.createElement("div",{className:"btn-group btn-group-toggle px-1","data-toggle":"buttons"},i.a.createElement("label",{className:"btn btn-secondary active"},i.a.createElement("input",{type:"radio",name:"options",id:"option1",autoComplete:"off"})," ",i.a.createElement("img",{src:"./rent32.ico",alt:"Rent",onClick:function(){e.toggleRentView(!0)}})),i.a.createElement("label",{className:"btn btn-secondary"},i.a.createElement("input",{type:"radio",name:"options",id:"option2",autoComplete:"off"})," ",i.a.createElement("img",{src:"./personalView32.ico",alt:"Personal",onClick:function(){e.toggleRentView(!1)}}))),i.a.createElement(R.o,null,i.a.createElement(R.e,null,i.a.createElement("img",{src:"./menu32.png",alt:"Menu"})),i.a.createElement(R.d,{right:!0},i.a.createElement(R.c,{header:!0},"Menu"),this.props.auth.admin?i.a.createElement(R.c,{onClick:function(){e.onChangeModalRemote({id:"-",addMode:!0})}},"Add item"):"",i.a.createElement(R.c,{onClick:this.toggleUserModalRemote},"Settings"),i.a.createElement(R.c,{onClick:function(){return e.logout()}},"Logout"))))),i.a.createElement(R.b,{isOpen:!this.state.collapsed,navbar:!0},i.a.createElement(R.l,{navbar:!0},i.a.createElement(R.m,null,i.a.createElement("form",null,i.a.createElement("div",{className:"form-row"},i.a.createElement("div",{className:"form-group col-md-12"},i.a.createElement("input",{type:"text",className:"form-control",id:"inputIdNameBrandModel",placeholder:"Search by serial, name, model, brand.",onChange:this.handleChange,value:this.state.inputIdNameBrandModel}))),i.a.createElement("div",{className:"form-row"},i.a.createElement("div",{className:"form-group col-md-4"},i.a.createElement("select",{onChange:this.handleChange,value:this.state.inputAddressDd,id:"inputAddressDd",className:"form-control"},i.a.createElement("option",{value:""},"Location"),this.state.dropdownData.address)),i.a.createElement("div",{className:"form-group col-md-4"},i.a.createElement("select",{onChange:this.handleChange,value:this.state.inputOwnerDd,id:"inputOwnerDd",className:"form-control"},i.a.createElement("option",{value:""},"Owner"),this.state.dropdownData.owner)),i.a.createElement("div",{className:"form-group col-md-4"},i.a.createElement("select",{onChange:this.handleChange,value:this.state.inputCategoryDd,id:"inputCategoryDd",className:"form-control"},i.a.createElement("option",{value:""},"Category"),this.state.dropdownData.category))))))))),i.a.createElement(k,{search:{text:this.state.inputIdNameBrandModel,address:this.state.inputAddressDd,owner:this.state.inputOwnerDd,category:this.state.inputCategoryDd},rentView:this.state.rentView,updateTableRowsGetSet:this.updateTableRowsGetSet,toggleModalRemote:this.onChangeModalRemote,onItemChangeRemote:this.onItemChangeRemote,auth:this.props.auth}),i.a.createElement(_,{updateDropdowns:this.updateDropdowns,dropdownData:this.state.dropdownData,toggleModal:this.onChangeModalGetSet,auth:this.props.auth,onItemChangeRemote:this.onItemChangeRemote}),i.a.createElement(F,{toggleUserModalGetSet:this.toggleUserModalGetSet,username:this.props.auth.username}))}}]),t}(n.Component),V=function(e){function t(){return Object(o.a)(this,t),Object(d.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return i.a.createElement("option",{value:this.props.rowData},this.props.rowData)}}]),t}(n.Component),x=A,U=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(d.a)(this,Object(c.a)(t).call(this,e))).state={auth:{username:"",authenticated:!1,admin:!1}},a.onLogout=a.onLogout.bind(Object(m.a)(Object(m.a)(a))),a.onLogin=a.onLogin.bind(Object(m.a)(Object(m.a)(a))),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"onLogin",value:function(e,t){var a=this;return new Promise(function(n,i){v.login(e,t).then(function(e){a.setState({auth:{authenticated:!0,userId:e.id,admin:e.admin,username:e.username}})}).then(function(){return n()}).catch(function(e){return i(console.log(e))})})}},{key:"onLogout",value:function(){var e=this;return new Promise(function(t,a){v.logout().then(function(){e.setState({auth:{authenticated:!1,userId:"",admin:!1,username:""}})}).then(function(){return t()}).catch(function(e){return a(console.log(e))})})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"App"},i.a.createElement(p.a,null,i.a.createElement(h.a,{exact:!0,path:"/",render:function(t){return i.a.createElement(y,Object.assign({},t,{Login:e.onLogin}))}}),this.state.auth.authenticated?i.a.createElement(h.a,{exact:!0,path:"/main",render:function(t){return i.a.createElement(x,Object.assign({},t,{logout:e.onLogout,auth:e.state.auth}))}}):i.a.createElement(f.a,{to:{pathname:"/",state:{from:this.props.location}}}),i.a.createElement(h.a,{path:"*",component:function(){return"404 NOT FOUND"}})))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var H=a(39);s.a.render(i.a.createElement(H.a,null,i.a.createElement(U,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[26,2,1]]]);
//# sourceMappingURL=main.93854e8f.chunk.js.map